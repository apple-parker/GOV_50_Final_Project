---
title: "Gov 50 Final Project"
author: "Adelaide Parker"
description: "Final project for GOV 50"
output:
  distill::distill_article:
    self_contained: false
---
## Introduction

### Background

Utah is a deeply red state—over 50% of Utah voters are registered as Republicans or lean to the right, and Utah hasn’t elected a Democratic Senator in over fifty years. But in 2022, Utah was home to one of the most unique—and surprisingly competitive—Senate races in U.S. history.

In Utah’s 2022 Senate election, there was no democratic candidate at all. The Utah Democratic party voted not to endorse a nominee and instead threw their support behind independent candidate Evan McMullin. Utah Democrats hoped McMullin would stand a higher chance at defeating incumbent Senator Mike Lee, whom many Utahns had grown dissatisfied with for his strong support of Donald Trump and role in seeking to overturn the 2020 Presidential election. McMullin drew a wide coalition of support from Utah Democrats, independents, and anti-Trump Republicans.

Lee ultimately won the election, but it was Utah’s most competitive Senate race since 1976. Utah’s 2022 Senate election has cast into question how safely partisan states like Utah really are and has given U.S. minority coalitions a potential new electoral strategy.

### Research question and hypothesis

How are Utah counties’ population densities correlated with their support for McMullin in 2022?

I hypothesize that Utah counties’ population densities share a positive correlation with those counties’ support for Evan McMullin in the 2022 Senate race. Urban areas are generally more liberal than rural areas, and support for McMullin tended to be higher among liberal Utahns than it was among conservative Utahns (because the Utah Democratic party encouraged its voters to support McMullin, and because McMullin’s opponent was a Republican).

Because McMullin drew support from across party lines, it is hard to predict support for him based solely on partisan data. Looking at population density instead could help provide a more nuanced view of where candidates like McMullin are likely to find support—not only from strict Democrats or Republicans, but also from independents or conventional party members with uncommon leanings. Party coalitions in states like Alaska are already looking at applying McMullin’s strategy (fielding an independent instead of a major-party candidate) in future elections. Analyzing where people like McMullin draw their support from will be important when assessing whether this strategy will be electorally viable in the future, and will be vital to geographic allocations of ad money and campaign events if others do decide to emulate McMullin.

## Data

This project relies on two datasets, one showing 2022 Senate election results and one showing Utah counties’ population densities. My election results dataset is drawn from the MIT Elections Lab. Their dataset initially displayed all 2022 Senate votes by county for each U.S. state, but I filtered the dataset down to only Utah counties, then filtered the candidates down to only McMullin and Lee (so excluding write-ins and other fringe candidates). I also created a tibble called `percentage_votes` that shows what percent of the total Lee/McMullun votes by county went to Lee, and what percent went to McMullin. My population density dataset is drawn from USA.com, which sources its data from the 2020 U.S. Census. I added this data into my election results dataset by creating a new tibble called `population_density.`

```{r}
## PRELIMINARY DATA WORK

# Load packages
library(tidyverse)
library(dplyr)

# Load CSV
senate_data <- read_csv("senate_2022.csv")

# Filter the data for Utah
utah_data <- senate_data |>
  filter(state_po == "UT")

# Create a dataset that only shows votes for Lee and McMullin
lee_mcmullin <- utah_data |>
  filter(candidate == "EVAN MCMULLIN" | candidate == "MIKE LEE")

# Create a data frame with population density information
population_density <- tibble(
  county_name = c("SALT LAKE", "DAVIS", "WEBER", "UTAH", "CACHE", 
                  "WASHINGTON", "WASATCH", "SUMMIT", "SANPETE", "MORGAN", 
                  "CARBON", "IRON", "SEVIER", "TOOELE", "UINTAH", "BOX ELDER",
                  "DUCHESNE", "JUAB", "GRAND", "BEAVER", "PIUTE", "EMERY",
                  "RICH", "SAN JUAN", "MILLARD", "KANE", "WAYNE", "DAGGETT", "GARFIELD"),
  density = c(1317.5, 501.0, 358.4, 252.1, 98.9, 59.6, 21.2, 20.1, 17.6, 16.3,
              14.2, 14.2, 10.8, 8.2, 7.7, 7.5, 6.0, 3.0, 2.5, 2.5, 2.5, 2.4, 
              2.1, 1.9, 1.8, 1.8, 1.1, 1.0, 1.0))

# Join the population density data with the original dataset
lee_mcmullin_density <- lee_mcmullin |>
  inner_join(population_density, by = "county_name")

# Summarize total votes by county and candidate
votes_by_candidate <- lee_mcmullin |>
  group_by(county_name, candidate) |>
  summarize(total_votes = sum(candidatevotes))

# Calculate total votes by county
total_votes_by_county <- votes_by_candidate |>
  group_by(county_name) |>
  summarize(total_votes_county = sum(total_votes))

# Join the data back and calculate percentage
percentage_votes <- votes_by_candidate |>
  inner_join(total_votes_by_county, by = "county_name") |>
  mutate(percentage = (total_votes / total_votes_county) * 100)

# Troubleshooting - join population_density with percentage_votes
percentage_votes_with_density <- percentage_votes |>
  left_join(population_density, by = "county_name")
```
In this project, my explanatory variable is Utah counties’ population densities (measured in people per sq. mile).

![Population Density of Utah Counties (Map)](UT_Pop_Map.png)

My outcome variable is those counties’ support for Evan McMullin in the 2022 election (measured as the % of each county’s votes that were cast for McMullin, out of each county’s aggregate total # of votes for both Lee and McMullin).

```{r}
# Graphing votes for Mike Lee and Evan McMullin by county
ggplot(lee_mcmullin, aes(x = county_name, y = candidatevotes, fill = candidate)) +
  geom_bar(stat = "identity", position = "dodge") +
  scale_y_log10() +
  scale_fill_manual(values = c("MIKE LEE" = "lightcoral", "EVAN MCMULLIN" = "gold")) +
  theme_minimal() +
  labs(title = "Votes by County for Mike Lee and Evan McMullin",
       x = "County",
       y = "Number of Votes (log scale)",
       fill = "Candidate") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


```{r}
## VARIABLES OF INTEREST - POPULATION DENSITY, % OF VOTES FOR MCMULLIN BY COUNTY

# Filter data for Evan McMullin
mcmullin_data <- percentage_votes_with_density |>
  filter(candidate == "EVAN MCMULLIN")

# Graph for Evan McMullin votes by county
ggplot(mcmullin_data, aes(x = reorder(county_name, density), y = percentage, fill = candidate)) +
  geom_bar(stat = "identity", position = "dodge") +
  scale_fill_manual(values = c("EVAN MCMULLIN" = "gold")) +
  theme_minimal() +
  labs(title = "% of Votes for Evan McMullin, By UT County",
       x = "County (Ordered by Pop. Density, Lowest to Highest)",
       y = "Percentage of Votes") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
I seek to assess the correlation between these two variables and analyze whether population density can be used as a predictor for support for McMullin. My research design is observational, correlational analysis—I do not seek to make any claims about causation.

```{r}
# Filter data for Evan McMullin
mcmullin_data <- percentage_votes_with_density |>
  filter(candidate == "EVAN MCMULLIN")

# Graph for Evan McMullin votes by county
ggplot(mcmullin_data, aes(x = reorder(county_name, density), y = percentage, fill = candidate)) +
  geom_bar(stat = "identity", position = "dodge") +
  scale_fill_manual(values = c("EVAN MCMULLIN" = "gold")) +
  theme_minimal() +
  labs(title = "% of Votes for Evan McMullin, By UT County",
       x = "County (Ordered by Pop. Density, Lowest to Highest)",
       y = "Percentage of Votes") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


```{r}
## POP DENSITY V MCMULLIN VOTES SCATTERPLOT

# Create a scatter plot with a logarithmic x-axis and a confidence interval for the line of best fit
ggplot(mcmullin_data, aes(x = density, y = percentage)) +
  geom_point(aes(color = county_name), size = 3) +
  geom_smooth(method = "lm", se = TRUE, color = "blue") +
  scale_x_log10() +
  theme_minimal() +
  labs(title = "% of Votes for Evan McMullin by Population Density",
       x = "Population Density (Log scale)",
       y = "Percentage of Votes",
       color = "County") + # Legend title for counties
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


```

